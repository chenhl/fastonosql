CMAKE_MINIMUM_REQUIRED(VERSION 3.6.3) # OPENSSL_USE_STATIC_LIBS
PROJECT(hiredis)

FIND_PACKAGE(OpenSSL REQUIRED)
FIND_PACKAGE(Libssh2 REQUIRED CONFIG)

SET(HIREDIS_INCLUDE_DIRS ${CMAKE_CURRENT_LIST_DIR}/deps/hiredis ${CMAKE_CURRENT_LIST_DIR}/src ../sds $<TARGET_PROPERTY:Libssh2::libssh2,INTERFACE_INCLUDE_DIRECTORIES> ${OPENSSL_INCLUDE_DIR})

SET(HEADERS_HIREDIS
  deps/hiredis/fmacros.h
  deps/hiredis/read.h
  deps/hiredis/net.h
  deps/hiredis/hiredis.h
)

SET(SOURCES_HIREDIS
  deps/hiredis/net.c
  deps/hiredis/read.c
  deps/hiredis/hiredis.c
)

ADD_LIBRARY(hiredis STATIC ${HEADERS_HIREDIS} ${SOURCES_HIREDIS})
TARGET_INCLUDE_DIRECTORIES(hiredis PRIVATE ${HIREDIS_INCLUDE_DIRS})
TARGET_INCLUDE_DIRECTORIES(hiredis PRIVATE Libssh2::libssh2 ${OPENSSL_LIBRARIES})
